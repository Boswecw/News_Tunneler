<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Opportunities Report</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 20px auto;
            background-color: #ffffff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            padding: 30px 20px;
            text-align: center;
        }
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 24px;
            font-weight: 600;
        }
        .header p {
            margin: 0;
            font-size: 14px;
            opacity: 0.9;
        }
        .content {
            padding: 30px 20px;
        }
        .snapshot {
            background-color: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 4px;
        }
        .snapshot h2 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #667eea;
        }
        .snapshot-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        .snapshot-item {
            font-size: 13px;
        }
        .snapshot-label {
            color: #666;
            font-weight: 500;
        }
        .snapshot-value {
            color: #333;
            font-weight: 600;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            font-size: 18px;
            margin: 0 0 15px 0;
            color: #333;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 8px;
        }
        .section h2.buys {
            color: #10b981;
            border-color: #10b981;
        }
        .section h2.sells {
            color: #ef4444;
            border-color: #ef4444;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        th {
            background-color: #f8f9fa;
            padding: 10px 8px;
            text-align: left;
            font-weight: 600;
            color: #666;
            border-bottom: 2px solid #e0e0e0;
        }
        td {
            padding: 12px 8px;
            border-bottom: 1px solid #f0f0f0;
        }
        tr:hover {
            background-color: #f8f9fa;
        }
        .ticker {
            font-weight: 700;
            font-size: 14px;
            color: #667eea;
        }
        .positive {
            color: #10b981;
            font-weight: 600;
        }
        .negative {
            color: #ef4444;
            font-weight: 600;
        }
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .badge-bullish {
            background-color: #d1fae5;
            color: #065f46;
        }
        .badge-bearish {
            background-color: #fee2e2;
            color: #991b1b;
        }
        .badge-neutral {
            background-color: #e5e7eb;
            color: #374151;
        }
        .catalyst-list {
            list-style: none;
            padding: 0;
            margin: 10px 0;
        }
        .catalyst-list li {
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
            color: #555;
        }
        .catalyst-list li:last-child {
            border-bottom: none;
        }
        .disclaimer {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 25px;
            border-radius: 4px;
            font-size: 12px;
            color: #856404;
        }
        .disclaimer strong {
            display: block;
            margin-bottom: 5px;
        }
        .footer {
            background-color: #f8f9fa;
            padding: 20px;
            text-align: center;
            font-size: 12px;
            color: #666;
        }
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }
        .empty-state svg {
            width: 64px;
            height: 64px;
            margin-bottom: 15px;
            opacity: 0.3;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>📊 Daily Opportunities Report</h1>
            <p>{{ session_label }} Session • {{ report_date }} at {{ report_time }}</p>
        </div>

        <!-- Content -->
        <div class="content">
            <!-- Market Snapshot -->
            <div class="snapshot">
                <h2>📈 Market Snapshot</h2>
                <div class="snapshot-grid">
                    <div class="snapshot-item">
                        <div class="snapshot-label">Market Mood</div>
                        <div class="snapshot-value">{{ market_snapshot.market_mood }}</div>
                    </div>
                    <div class="snapshot-item">
                        <div class="snapshot-label">Confidence Range</div>
                        <div class="snapshot-value">{{ market_snapshot.confidence_range }}</div>
                    </div>
                </div>
                {% if market_snapshot.notable_catalysts %}
                <div style="margin-top: 15px;">
                    <div class="snapshot-label">Notable Catalysts</div>
                    <ul class="catalyst-list">
                        {% for catalyst in market_snapshot.notable_catalysts %}
                        <li>{{ catalyst }}</li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>

            <!-- Best Times to BUY -->
            <div class="section">
                <h2 class="buys">🚀 Best Opportunities to BUY ({{ buys|length }})</h2>
                <p style="color: #666; font-size: 14px; margin-top: -10px; margin-bottom: 15px;">
                    Stocks predicted to rise — consider buying now to sell later for profit
                </p>
                {% if buys %}
                <table>
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Expected</th>
                            <th>Conf.</th>
                            <th>R²</th>
                            <th>RSI</th>
                            <th>Trend</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for opp in buys %}
                        <tr>
                            <td class="ticker">{{ opp.symbol }}</td>
                            <td class="positive">+{{ "%.1f"|format(opp.expected_return_pct) }}%</td>
                            <td>{{ "%.0f"|format((opp.llm_confidence or opp.ml_confidence or 0) * 100) }}%</td>
                            <td>{{ "%.2f"|format(opp.model_r2 or 0) }}</td>
                            <td>{{ "%.0f"|format(opp.rsi or 0) }}</td>
                            <td><span class="badge badge-{{ 'bullish' if 'Above' in opp.trend else 'neutral' }}">{{ opp.trend }}</span></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="empty-state">
                    <p>No buy opportunities meet the criteria today.</p>
                </div>
                {% endif %}
            </div>

            <!-- Best Times to SELL -->
            <div class="section">
                <h2 class="sells">📉 Best Opportunities to SELL ({{ sells|length }})</h2>
                <p style="color: #666; font-size: 14px; margin-top: -10px; margin-bottom: 15px;">
                    Stocks predicted to decline — consider selling now before they drop
                </p>
                {% if sells %}
                <table>
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Expected</th>
                            <th>Conf.</th>
                            <th>R²</th>
                            <th>RSI</th>
                            <th>Trend</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for opp in sells %}
                        <tr>
                            <td class="ticker">{{ opp.symbol }}</td>
                            <td class="negative">{{ "%.1f"|format(opp.expected_return_pct) }}%</td>
                            <td>{{ "%.0f"|format((opp.llm_confidence or opp.ml_confidence or 0) * 100) }}%</td>
                            <td>{{ "%.2f"|format(opp.model_r2 or 0) }}</td>
                            <td>{{ "%.0f"|format(opp.rsi or 0) }}</td>
                            <td><span class="badge badge-{{ 'bearish' if 'Below' in opp.trend else 'neutral' }}">{{ opp.trend }}</span></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="empty-state">
                    <p>No sell opportunities meet the criteria today.</p>
                </div>
                {% endif %}
            </div>

            <!-- Disclaimer -->
            <div class="disclaimer">
                <strong>⚠️ Educational Purpose Only</strong>
                This report is for informational and educational purposes only. It does not constitute financial advice, investment recommendations, or an offer to buy or sell securities. Past performance does not guarantee future results. Always conduct your own research and consult with a qualified financial advisor before making investment decisions.
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>News Tunneler • Automated Trading Insights</p>
            <p>Generated on {{ report_date }} at {{ report_time }}</p>
        </div>
    </div>
</body>
</html>

